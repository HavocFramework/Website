# 12. Client Script

This section describes all of the different API functions that can be used to
control the client side of havoc. The API scripting language of choice is python
to allow users to utilise the power and simplicity of python.

## Installing extensions

### Manual Install

If you wish to install Havoc client side modules manually it is quite easy. The
Havoc app provides a script manager tab where modules can be loaded. This can
be accessed through Scripts > Scripts Manager.

![Havoc Script Manager page](/images/assets/HavocScriptManager.png)

You can either select *Load Script* to load a script or select a currently loaded
script to either Reload it or removes it.

![Havoc Script Manager page](/images/assets/HavocScriptManagerSubMenu.png)

### Extensions tab inside of the GUI

The havoc python API also includes a store where you can download directly inside
of havoc different extensions for the front-end. This interface is accessible to
users through Attack > Extensions.

#### Contribute your extensions to the store

Currently the store is located on the [following repo](https://github.com/p4p1/havoc-store)
more details can be found directly there on publishing your own module. Make sure
that your module does not change the directory of Havoc with *os.chdir* to not
break dependencies. You can publish your module by doing a pull request directly
on the repo after editing the json file that is downloaded by the front-end inside
of public/havoc-modules.json. A json entry should look like the following:
```
  {
    "title":"<your title>",
    "description":"<Your description>",
    "author":"<Your username on github>",
    "link":"<the link to the module>",
    "preview":"<The preview image of the module",
    "category": {
        "BOF": false,
        "Console": false,
        "Graphical": true
    }
  }
```

![Havoc Extensions page](/images/assets/HavocExtentions.png)

## Python API Documentation

The python api is divided in two main section the havoc and havocui modules. The
first is used to control the behaviour of havoc from scripts to interacting with
demons. The havocui module is used to control the User Interface of havoc by
creating widgets and tabs.

### havoc

The main havoc library that allows you to interact with core components of Havoc,
from listeners to connected demons, registering commands and events.

```
import havoc
```

##### havoc.LoadScript()

A function that takes a string as an argument to represent the path of a python
script that will then be loaded into havoc.

| Arguments   | Description                                                        | Optional   |
| ----------- | ------------------------------------------------------------------ | ---------- |
| script path | The script that will be loaded inside of havoc.                    | No         |

```
import havoc

havoc.LoadScript("/tmp/havoc_python_script.py")
```

##### havoc.GetDemons()

A function that takes no arguments and will return a list of strings containing
every Demon ID connected to havoc.

```
import havoc

print(havoc.GetDemons()) # should result in [ "a havoc id", "another", .... ]
```

##### havoc.GetListeners()

A function that takes no arguments and will return a list of strings containing
the different listeners configured inside of havoc.

```
import havoc

print(havoc.GetListeners()) # should result in [ "a listener", "another", .... ]
```

##### havoc.GetAgents()

A function that takes no arguments and will return a list of strings containing
the different Agents configured inside of havoc. By default this function will
only return "Demon" unless you specified other Agents.

```
import havoc

print(havoc.GetAgents()) # should result in [ "Demon", .... ]
```

##### havoc.GeneratePayload()

A function that takes multiple arguments defined below to schedule the generation
of a payload and receive the base64 binary code and transfer it back to a python
callback.

| Arguments | Description                                                        | Optional   |
| --------- | ------------------------------------------------------------------ | ---------- |
| callback  | The callback function where the base 64 will be parsed as argument | No         |
| agent     | The agent that will be used during the payload generation          | No         |
| listener  | The specified listener the agent will call back to                 | No         |
| arch      | The architecture of the generated payload (x64 or x86)             | No         |
| format    | The format of the generated payload (exe or dll for example)       | No         |
| config    | The configuration of the payload                                   | No         |

```
import havoc

def catch_payload(data):
    print(data)

havoc.GeneratePayload(catch_payload, "Demon", "HTTPS Listener", "x64", "Windows Exe", "{\"Amsi/Etw Patch\": \"None\",\"Indirect Syscall\": false,\"Injection\": {\"Alloc\": \"Native/Syscall\",\"Execute\": \"Native/Syscall\",\"Spawn32\": \"C:\\\\Windows\\\\SysWOW64\\\\notepad.exe\",\"Spawn64\": \"C:\\\\Windows\\\\System32\\\\notepad.exe\"},\"Jitter\": \"15\",\"Proxy Loading\": \"None (LdrLoadDll)\",\"Sleep\": \"2\",\"Sleep Technique\": \"WaitForSingleObjectEx\",\"Stack Duplication\": false}")
```

##### havoc.RegisterCommand()

A function to register a command to the havoc command line interface when
interacting with an agent.

| Arguments   | Description                                                                           | Optional   |
| ------------|-------------------------------------------------------------------------------------- | ---------- |
| function    | The callback function that will be called when running the function.                  | No         |
| module      | The string representing the module of the command.                                    | No         |
| command     | The string representing the command.                                                  | No         |
| description | The description of the command .                                                      | No         |
| behaviour   | set the behaviour of the command. For now keep at 0 it is still under developement.   | No         |
| usage       | The usage of the command.                                                             | No         |
| example     | An example on how to use the command.                                                 | No         |
| agent       | The specific agent that you want the command to be defined to. Default is all agents. | Yes        |

```
import havoc

def samdump(demonID, *params):
    TaskID : str    = None
    demon  : Demon  = None
    packer = Packer()
    # ... more code
    # see full example in the SamDump module
    # https://github.com/HavocFramework/Modules

RegisterCommand( samdump, "", "samdump", "Dump the SAM, SECURITY and SYSTEM registries", 0, "<folder>", "C:\\Windows\\Temp\\" )
```

##### havoc.RegisterModule()

A function to register a module to the havoc command line interface that will then
store multiple commands under the module.

| Arguments   | Description                                                                                        | Optional   |
| ------------|--------------------------------------------------------------------------------------------------- | ---------- |
| Name        | The name of the module that will store the commands                                                | No         |
| description | The description of the Module.                                                                     | No         |
| behaviour   | set the behaviour of the module. For now keep as an empty string it is still under development.    | No         |
| usage       | The usage of the module.                                                                           | No         |
| example     | An example on how to use the command.                                                              | No         |
| Options     | Still under development.                                                                           | No         |

```
import havoc

# more code ...
# see full example in the jmp-exec module
# https://github.com/HavocFramework/Modules

RegisterModule( "jump-exec", "lateral movement module", "", "[exploit] (args)", "", ""  )
```

##### havoc.RegisterCallback()

A function to register a callback inside of Havoc.

| Arguments   | Description                                             | Optional   |
| ------------|-------------------------------------------------------- | ---------- |
| callback    | The function that will be called during client connect. | No         |

_it is more recommended to use Events_

```
import havoc

def callback(text):
    print('this is a callback')

havoc.RegisterCallback(callback)
```

#### havoc.Demon()

A class to interact with a demon. Takes the demon identifier as argument.

| Arguments   | Description                                             | Optional   |
| ------------|-------------------------------------------------------- | ---------- |
| DemonId     | The string that represents the demon to control.        | No         |

```
import havoc

instance = havoc.Demon("identifier")
```

| Variables     | Description                                             | Default value |
| --------------|-------------------------------------------------------- | ------------- |
| Listener      | The Listener the demon is connected to.                 | NaN           |
| DemonID       | The string representing the identifier of the demon.    | NaN           |
| External IP   | The External IP address of the demon.                   | NaN           |
| Internal IP   | The Internal IP address of the demon.                   | NaN           |
| User          | The user running the demon.                             | NaN           |
| Computer      | The computer the demon is running on.                   | NaN           |
| Domain        | The Domain the demon is part off.                       | NaN           |
| OS            | The Operating system of the demon.                      | NaN           |
| OSBuild       | The Operating system build information.                 | NaN           |
| OSArch        | The Architecture of the Operating system.               | NaN           |
| ProcessName   | The name of the process running the demon.              | NaN           |
| ProcessID     | The ID number of the process running the demon.         | NaN           |
| ProcessArch   | The Architecture of the process running the demon.      | NaN           |
| --------------|-------------------------------------------------------- | ------------- |
| CONSOLE_INFO  | The console message type information.                   | 1             |
| CONSOLE_ERROR | The console message type error.                         | 2             |
| CONSOLE_TASK  | The console message type task.                          | 3             |

##### havoc.Demon().ConsoleWrite()

A function that takes two arguments to write on the console of an agent. This function
will return a taskId depending on the argument specified to the function.

| Arguments   | Description                                              | Optional   |
| ------------|--------------------------------------------------------- | ---------- |
| Type        | The type of message requested                            | No         |
| Message     | The message to be displayed on the console of the agent. | No         |

| Message type  | Description                                              | Value   |
| --------------|--------------------------------------------------------- | ------- |
| CONSOLE_INFO  | The console message type information.                    | 1       |
| CONSOLE_ERROR | The console message type error.                          | 2       |
| CONSOLE_TASK  | The console message type task.                           | 3       |

```
import havoc

instance = havoc.Demon("identifier")
instance.ConsoleWrite(havoc.CONSOLE_INFO, "Hello World")
```

##### havoc.Demon().ProcessCreate()

A function to create a process on the demon. This function will take six arguments
to manage the process.

| Arguments   | Description                                                | Optional   |
| ------------|----------------------------------------------------------- | ---------- |
| TaskId      | The Identifier of the task sent to the demon.              | No         |
| App         | The application to be ran on the target demon.             | No         |
| CmdLine     | The command line arguments to the process.                 | No         |
| Suspend     | A boolean value if you wish to have the process suspended. | No         |
| Piped       | A boolean value if the process is piped.                   | No         |
| Verbose     | A boolean value if the process is verbose.                 | No         |

```
import havoc

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a process")
instance.ProcessCreate(TaskID, "notepad.exe", "", False, False, False)
```

##### havoc.Demon().InlineExecute()

Execute a beacon object file on the selected demon instance. The function takes
five arguments to execute the file.

| Arguments   | Description                                                   | Optional   |
| ------------|-------------------------------------------------------------- | ---------- |
| TaskId      | The Identifier of the task sent to the demon.                 | No         |
| EntryFunc   | The entry function of the beacon object file.                 | No         |
| Path        | The path to the beacon object file.                           | No         |
| ArgBytes    | The different arguments to send to the function.              | No         |
| Threaded    | A boolean value if the beacon object file is ran in a thread. | No         |

```
import havoc

# Example taken form samdump.
# https://github.com/HavocFramework/Modules

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a bof file")
demon.InlineExecute( TaskID, "go", f"regdump.samdump.o", packer.getbuffer(), False )
```

##### havoc.Demon().InlineExecuteGetOutput()

Execute a beacon object file on the selected demon instance. The function takes
Four arguments to execute the file and returns the output through a callback.

| Arguments   | Description                                                   | Optional   |
| ------------|-------------------------------------------------------------- | ---------- |
| Callback    | The callback to receive the output of the beacon file.        | No         |
| EntryFunc   | The entry function of the beacon object file.                 | No         |
| Path        | The path to the beacon object file.                           | No         |
| ArgBytes    | The different arguments to send to the function.              | No         |

```
import havoc

# Example inspired form bofbelt.
# https://github.com/HavocFramework/Modules

instance = havoc.Demon("identifier")

def callback(demonID, TaskID, worked, output, error):
	# demonID: the ID of the demon that ran the BOF
	# TaskID : the ID of the task returned by demon.InlineExecuteGetOutput
	# worked : weather the BOF was able to run or not
	# output : the content of all CALLBACK_OUTPUT
	# error  : the content of all CALLBACK_ERROR
	global instance
	if  worked:
		instance.ConsoleWrite(demon.CONSOLE_INFO, output)
	else:
		instance.ConsoleWrite(demon.CONSOLE_ERROR, output)

demon.InlineExecuteGetOutput( callback , "go", f"regdump.samdump.o", packer.getbuffer(), False )
```
##### havoc.Demon().DllSpawn()

Spawn a dll on the demon. This function takes three arguments.

| Arguments     | Description                                                   | Optional   |
| --------------|-------------------------------------------------------------- | ---------- |
| TaskID        | The identifier number of the task to the demon.               | No         |
| Dll path      | The path of the dll to run on the machine.                    | No         |
| Dll arguments | The arguments to the dll.                                     | No         |

```
import havoc

# Example taken from powerpick.
# https://github.com/HavocFramework/Modules

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a dll file")
demon.DllSpawn( TaskID, "bin/PowerPick.x64.dll", packer.getbuffer() )
```

##### havoc.Demon().DllInject()

Spawn a dll on the demon inside of an existing process . This function takes
four arguments.

| Arguments     | Description                                                   | Optional   |
| --------------|-------------------------------------------------------------- | ---------- |
| TaskID        | The identifier number of the task to the demon.               | No         |
| PID           | Process identifier to inject in.                              | No         |
| Dll path      | The path of the dll to run on the machine.                    | No         |
| Dll arguments | The arguments to the dll.                                     | No         |

```
import havoc

# Example inspired from powerpick.
# https://github.com/HavocFramework/Modules

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a dll file")
demon.DllSpawn( TaskID, "1030", "bin/PowerPick.x64.dll", packer.getbuffer() )
```

##### havoc.Demon().DotnetInlineExecute()

Run a dotnet binary inside of the demon instance. This function takes three arguments.

| Arguments     | Description                                                   | Optional   |
| --------------|-------------------------------------------------------------- | ---------- |
| TaskID        | The identifier number of the task to the demon.               | No         |
| Path          | The path of the exe to run on the machine.                    | No         |
| Arguments     | The arguments to the exe.                                     | No         |

```
import havoc

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a dotnet exe file")
demon.DotnetInlineExecute( TaskID, "/opt/exe/SharpChrome.exe", "all the arguments" ) )
```

##### havoc.Demon().Command()

Run a command inside of the demon instance. This function takes two arguments.

| Arguments     | Description                                                   | Optional   |
| --------------|-------------------------------------------------------------- | ---------- |
| TaskID        | The identifier number of the task to the demon.               | No         |
| Command       | The command to run on the demon.                              | No         |

```
import havoc

# example taken from auto_suite.py
# https://gist.github.com/p4p1/e24bca8407d69c8ea28d4bc9d423f85b

instance = havoc.Demon("identifier")
TaskID = instance.ConsoleWrite(havoc.CONSOLE_TASK, "Launching a command")
demon.Command( TaskID, "powershell \"Get-ChildItem -Path C:\\\\ -Filter *.exe -Recurse\"") )
```

#### havoc.Event()

The event class in python used to hook functions on events inside of havoc.

```
import havoc

# currently takes a string as argument but is not used...
event = havoc.Event("events")
```

##### havoc.Event().OnNewSession()

Run a callback function when a new session is joined on havoc.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The function that will ran on a new session is connected to havoc. | No         |

```
import havoc

# Example inspired of auto_suite.py
# https://gist.github.com/p4p1/e24bca8407d69c8ea28d4bc9d423f85b

def run_bofbelt(demon_id):
    demon = havoc.Demon(demon_id)
    TaskID = demon.ConsoleWrite( demon.CONSOLE_TASK, "Tasked demon to auto-run bofbelt" )
    demon.Command(TaskID, "bofbelt")

# currently takes a string as argument but is not used...
event = havoc.Event("events")

event.OnNewSession(run_bofbelt)
```

### havocui

The havocui section is built to interact with the User Interface of havoc. It
allows users to interact with your modules through custom menu's and interfaces.
The havocui module ranges from simple message boxes to Full fledged dialog,
widgets and pre built widgets that allow you to display important information
like logs.

```
import havocui
```

##### havocui.messagebox()

Create a simple message box to display text. This function takes two arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the message box.                                      | No         |
| Message       | The message to be displayed inside of your message box.            | No         |

```
import havocui

havocui.messagebox("sample message box", "Hello World!")
```

![message box](/images/assets/pythonapi/messagebox.png)

##### havocui.errormessage()

Create a simple message box to display an error message. This function takes one
argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Message       | The message to be displayed inside of your error box.              | No         |

```
import havocui

havocui.errormessage("This is an error :(")
```

![error box](/images/assets/pythonapi/errormessage.png)

##### havocui.createtab()

Function to create a tab menu element to display. This function takes an infinite
number of arguments but should at minimum take 3.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Tab title     | The title of the tab inside of the havoc GUI.                      | No         |
| Element title | The title of the element inside of the tab.                        | No         |
| callback      | The callback function for when the tab is selected.                | No         |
| ------------- | ------------------------------------------------------------------ | ---------- |
| Element title | The title of the element inside of the tab.                        | Yes        |
| callback      | The callback function for when the tab is selected.                | Yes        |

```
import havocui

# code taken from auto_suite.py
# https://gist.github.com/p4p1/e24bca8407d69c8ea28d4bc9d423f85b

def open_autosearch():
	# some code
	# ....

havocui.createtab("Auto Suite", "Auto search", open_autosearch)
```

![create tab](/images/assets/pythonapi/createtab.png)

##### havocui.inputdialog()

Create a simple dialog box that will get user input. This function takes two
arguments and will return the data entered by the user. If cancel is selected
the return string will be empty.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the input box.                                        | No         |
| Message       | The message to be displayed inside of your input box.              | No         |

```
import havocui

print(havocui.errormessage("Enter something", "Please provide your name:"))
# should result in displaying in the console the text entered
```

![input dialog](/images/assets/pythonapi/inputdialog.png)

##### havocui.openfiledialog()

A function that will open a dialog box to open a file. This function takes one
argument and will return the path to the file.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the open file dialog.                                 | No         |

```
import havocui

print(havocui.openfiledialog("select file"))
# should result in displaying in the console the path and the file selected
```

![open file dialog](/images/assets/pythonapi/openfiledialog.png)

##### havocui.savefiledialog()

A function that will open a dialog box to save a file. This function takes one
argument and will return the path to the file.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the save file dialog.                                 | No         |

```
import havocui

print(havocui.savefiledialog("save file"))
# should result in displaying in the console the path and the file entered
```

![save file dialog](/images/assets/pythonapi/savefiledialog.png)

##### havocui.questiondialog()

A function that will open a dialog with a yes and no option. This function takes two
arguments and returns a boolean depending on the answer.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the question dialog.                                  | No         |
| Question      | The question asked to the user.                                    | No         |

```
import havocui

value = havocui.questiondialog("question", "Are you happy?")
if value == True:
	print("you are happy")
else:
	havocui.inputdialog("why...", "why are you sad?")
```

![question dialog](/images/assets/pythonapi/questiondialog.png)

##### havocui.colordialog()

A function that opens a dialog box to pick colors. This function takes no arguments
and returns the hexadecimal color code.

```
import havocui

print(havocui.colordialog())
# this will result in displaying the hex color code in the console
```

![color dialog](/images/assets/pythonapi/colordialog.png)

##### havocui.progressdialog()

A function that opens a dialog box to display the progress of a long operation.
This function takes four arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the progress dialog.                                  | No         |
| Message       | The message to be displayed during progress.                       | No         |
| Callback      | The callback function to set the behavior of the progress.         | No         |
| Number        | The number to set the number of iterations to call the callback.   | No         |

```
import havocui

a = 0

def callback():
    global a
    a += 1
    if a > 100:
        a = -1 # return a negative number to automatically close the dialog.
    return a

havocui.progressdialog("progress bar", "This task might take some time...", callback, 100)
```

![progress dialog](/images/assets/pythonapi/progressdialog.png)

#### havocui.Dialog()

A python module to create a custom dialog window with the ability to add
different pre-defined widgets. The module takes one argument and three extra optional
arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the progress dialog.                                  | No         |
| Scrollable    | A boolean to edit the behavior from fixed size to scrollable.      | Yes        |
| Width         | Set the width of the dialog.                                       | Yes        |
| Height        | Set the height of the dialog.                                      | Yes        |

```
import havocui

dialog = havocui.Dialog("Title", True, 600, 450)
```

![dialog example](/images/assets/pythonapi/dialogexample.png)

##### havocui.Dialog().exec()

A function to display the dialog on the screen. This function takes no arguments and
returns nothing.

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.exec() # Displays a dialog box of fixed size 100x100 with nothing inside
```

![exec](/images/assets/pythonapi/exec.png)

##### havocui.Dialog().close()

A function to close the dialog that is opened. This function takes no arguments and
returns nothing.

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.exec() # Displays a dialog box of fixed size 100x100 with nothing inside
dialog.close() # close the window
```

##### havocui.Dialog().addLabel()

A function to append a label inside of the created dialog. This function takes one
argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text present inside of the label.                              | No         |

_The text also have support for html styling._

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addLabel("Hello World!")
dialog.addLabel("<span style=\"color: red\">Hello red!</span>")
dialog.exec()
```

![add label dialog](/images/assets/pythonapi/addlabeldialog.png)

##### havocui.Dialog().addImage()

A function to append an image inside of a dialog. The function takes one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Path          | The path of the image to be displayed inside of the dialog.        | No         |

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addImage("/tmp/image.png")
dialog.exec()
```

![add image dialog](/images/assets/pythonapi/addimagedialog.png)

##### havocui.Dialog().addButton()

A function to append a button inside of a dialog. The function takes two arguments and
one optional argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text to be displayed inside of the button.                     | No         |
| Callback      | The callback function to be called when the button is pressed.     | No         |
| Style         | A string representing the style of the button.                     | Yes        |

[The style sheet reference of qt](https://doc.qt.io/qt-6/stylesheet-reference.html#list-of-properties)

```
import havocui

def callback():
	print("Button pressed!")

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addButton("Click to print", callback)
dialog.addButton("Styled click to print", callback, "background-color: blue; color: white; border: 2px solid black;")
dialog.exec()
```

![add button dialog](/images/assets/pythonapi/addbuttondialog.png)

##### havocui.Dialog().addCheckbox()

A function to append a checkbox inside of a dialog. The function takes two arguments and
two optional argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text to be displayed inside of the checkbox.                   | No         |
| Callback      | The callback function to be called when the checkbox is pressed.   | No         |
| Is_checked    | A boolean representing the default value of the checkbox           | Yes        |
| Style         | A string representing the style of the checkbox.                   | Yes        |

[The style sheet reference of qt](https://doc.qt.io/qt-6/stylesheet-reference.html#list-of-properties)

```
import havocui

def callback():
	print("Button pressed!")

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addCheckbox("Check to call print", callback)
dialog.addCheckbox("Styled checked to call print", callback, True, "QCheckBox { background-color: yellow; color: blue; }")
dialog.exec()
```

![add checkbox dialog](/images/assets/pythonapi/addcheckboxdialog.png)

##### havocui.Dialog().addCombobox()

A function to append a combobox to a dialog with two arguments and an infinite
amount of optional arguments that represent the different options that could be
selected.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the checkbox is pressed.   | No         |
| Option        | The first option to the combo box.                                 | No         |
| Option        | The rest of the arguments are infinite for the different options.  | Yes        |

```
import havocui
import havoc

listeners = havoc.GetListeners() # will return an array of listeners [ 'listener 1', ... ]

def callback(option):
	print(option) # will be the value of the selected element

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addCombobox(callback, "option 1", "option 2", "option 3")

dialog.addCombobox(callback, *listeners) # send the listeners as seperate arguments.
dialog.exec()
```

![add combo-box dialog](/images/assets/pythonapi/addcomboboxdialog.png)

##### havocui.Dialog().addLineedit()

A function to append a line edit to a dialog to get input from a user. This function
takes two arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Placeholder   | The placeholder text inside of the input area.                     | No         |
| Callback      | The callback function to be called when the text is edited.        | No         |

```
import havocui

def callback(text):
	print(text) # will be the value of the selected element

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addLineedit("Enter something ...", callback)
dialog.exec()
```

![add line edit dialog](/images/assets/pythonapi/addlineeditdialog.png)

##### havocui.Dialog().addCalendar()

A function to append a calendar widget to the dialog window. This function takes only
one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the date is edited.        | No         |

```
import havocui

def callback(date):
	print(date) # will be the value of the selected date

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addCalendar(callback)
dialog.exec()
```

![add calendar dialog](/images/assets/pythonapi/addcalendardialog.png)

##### havocui.Dialog().addDial()

A function to append a dial widget to the dialog window. This function takes only
one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the dial is rotated.       | No         |

```
import havocui

def callback(number):
	print(number) # will be the value of the dial 0-99

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addDial(callback)
dialog.exec()
```

![add dial dialog](/images/assets/pythonapi/adddialdialog.png)

##### havocui.Dialog().addSlider()

A function to append a slider widget to the dialog window. This function takes only
one argument and an optional one to set the slider horizontal or vertical.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the dial is rotated.       | No         |
| Vertical      | A boolean value if set to True will make the slider vertical.      | Yes        |

```
import havocui

def callback(number):
	print(number) # will be the value of the dial 0-99

dialog = havocui.Dialog("Title", False, 100, 100)
dialog.addSlider(callback)
dialog.addSlider(callback, True)
dialog.exec()
```

![add slider dialog](/images/assets/pythonapi/addsliderdialog.png)

##### havocui.Dialog().replaceLabel()

A function to search through a dialog to find the label with appropriate text and
replace it's value. The function takes two arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| To_find       | The current string that is inside of the label.                    | No         |
| To_replace    | The string to replace inside of the label.                         | No         |

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)

def callback():
	global dialog
	dialog.replaceLabel("change me", "changed to something new")

dialog.addLabel("change me")
dialog.addButton("change the label", callback)
dialog.exec()
```

![replace label dialog](/images/assets/pythonapi/replacelabeldialog.png)

##### havocui.Dialog().clear()

A function to clear the content of a dialog. This function takes no arguments.

```
import havocui

dialog = havocui.Dialog("Title", False, 100, 100)

def callback():
	global dialog
	dialog.clear()

dialog.addLabel("will go away")
dialog.addButton("click to clear dialog", callback)
dialog.exec()
```

![clear dialog](/images/assets/pythonapi/cleardialog.png)

#### havocui.Widget()

A python module to create a custom widget window with the ability to add
different pre-defined widgets. The module takes one argument and one extra optional
argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the progress dialog.                                  | No         |
| Scrollable    | A boolean to edit the behavior from fixed size to scrollable.      | Yes        |

```
import havocui

widget = havocui.Widget("Title", True)
```

![widget example](/images/assets/pythonapi/widgetexample.png)

##### havocui.Widget().setBottomTab()

A function to display the widget on the screen as a bottom tab. This function
takes no arguments and returns nothing.

```
import havocui

widget = havocui.Widget("Title", True)
widget.setBottomTab() # will display the widget as a bottom tab.
```

![set bottom tab](/images/assets/pythonapi/setbottomtab.png)

##### havocui.Widget().setSmallTab()

A function to display the widget on the screen as a small tab to the right.
This function takes no arguments and returns nothing.

```
import havocui

widget = havocui.Widget("Title", True)
widget.setSmallTab() # will display the widget as a small tab to the right.
```

![set small tab](/images/assets/pythonapi/setsmalltab.png)

##### havocui.Widget().addLabel()

A function to append a label inside of the created widget. This function takes one
argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text present inside of the label.                              | No         |

_The text also have support for html styling._

```
import havocui

widget = havocui.Widget("Title")
widget.addLabel("Hello World!")
widget.addLabel("<span style=\"color: red\">Hello red!</span>")
widget.setSmallTab()
```

![add label widget](/images/assets/pythonapi/addlabelwidget.png)

##### havocui.Widget().addImage()

A function to append an image inside of a widget. The function takes one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Path          | The path of the image to be displayed inside of the widget.        | No         |

```
import havocui

widget = havocui.Widget("Title")
widget.addImage("/tmp/image.png")
widget.setSmallTab()
```

![add image widget](/images/assets/pythonapi/addimagewidget.png)

##### havocui.Widget().addButton()

A function to append a button inside of a widget. The function takes two arguments and
one optional argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text to be displayed inside of the button.                     | No         |
| Callback      | The callback function to be called when the button is pressed.     | No         |
| Style         | A string representing the style of the button.                     | Yes        |

[The style sheet reference of qt](https://doc.qt.io/qt-6/stylesheet-reference.html#list-of-properties)

```
import havocui

def callback():
	print("Button pressed!")

widget = havocui.Widget("Title")
widget.addButton("Click to print", callback)
widget.addButton("Styled click to print", callback, "background-color: blue; color: white; border: 2px solid black;")
widget.setSmallTab()
```

![add button widget](/images/assets/pythonapi/addbuttonwidget.png)

##### havocui.Widget().addCheckbox()

A function to append a checkbox inside of a widget. The function takes two arguments and
two optional argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text to be displayed inside of the checkbox.                   | No         |
| Callback      | The callback function to be called when the checkbox is pressed.   | No         |
| Is_checked    | A boolean representing the default value of the checkbox           | Yes        |
| Style         | A string representing the style of the checkbox.                   | Yes        |

[The style sheet reference of qt](https://doc.qt.io/qt-6/stylesheet-reference.html#list-of-properties)

```
import havocui

def callback():
	print("Button pressed!")

widget = havocui.Widget("Title")
widget.addCheckbox("Check to call print", callback)
widget.addCheckbox("Styled checked to call print", callback, True, "QCheckBox { background-color: yellow; color: blue; }")
widget.setSmallTab()
```

![add checkbox widget](/images/assets/pythonapi/addcheckboxwidget.png)

##### havocui.Widget().addCombobox()

A function to append a combobox to a widget with two arguments and an infinite
amount of optional arguments that represent the different options that could be
selected.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the checkbox is pressed.   | No         |
| Option        | The first option to the combo box.                                 | No         |
| Option        | The rest of the arguments are infinite for the different options.  | Yes        |

```
import havocui
import havoc

listeners = havoc.GetListeners() # will return an array of listeners [ 'listener 1', ... ]

def callback(option):
	print(option) # will be the value of the selected element

widget = havocui.Widget("Title")
widget.addCombobox(callback, "option 1", "option 2", "option 3")

widget.addCombobox(callback, *listeners) # send the listeners as seperate arguments.
widget.setSmallTab()
```

![add combo-box widget](/images/assets/pythonapi/addcomboboxwidget.png)

##### havocui.Widget().addLineedit()

A function to append a line edit to a widget to get input from a user. This function
takes two arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Placeholder   | The placeholder text inside of the input area.                     | No         |
| Callback      | The callback function to be called when the text is edited.        | No         |

```
import havocui

def callback(text):
	print(text) # will be the value of the selected element

widget = havocui.Widget("Title")
widget.addLineedit("Enter something ...", callback)
widget.setSmallTab()
```

![add line edit widget](/images/assets/pythonapi/addlineeditwidget.png)

##### havocui.Widget().addCalendar()

A function to append a calendar widget to a widget. This function takes only
one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the date is edited.        | No         |

```
import havocui

def callback(date):
	print(date) # will be the value of the selected date

widget = havocui.Widget("Title")
widget.addCalendar(callback)
widget.setSmallTab()
```

![add calendar widget](/images/assets/pythonapi/addcalendarwidget.png)

##### havocui.Widget().addDial()

A function to append a dial to a widget. This function takes only one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the dial is rotated.       | No         |

```
import havocui

def callback(number):
	print(number) # will be the value of the dial 0-99

widget = havocui.Widget("Title")
widget.addDial(callback)
widget.setSmallTab()
```

![add dial widget](/images/assets/pythonapi/adddialwidget.png)

##### havocui.Widget().addSlider()

A function to append a slider to a widget. This function takes only
one argument and an optional one to set the slider horizontal or vertical.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Callback      | The callback function to be called when the dial is rotated.       | No         |
| Vertical      | A boolean value if set to True will make the slider vertical.      | Yes        |

```
import havocui

def callback(number):
	print(number) # will be the value of the dial 0-99

widget = havocui.Widget("Title")
widget.addSlider(callback)
widget.addSlider(callback, True)
widget.setBottomTab()
```

![add slider widget](/images/assets/pythonapi/addsliderwidget.png)

##### havocui.Widget().replaceLabel()

A function to search through a widget to find the label with appropriate text and
replace it's value. The function takes two arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| To_find       | The current string that is inside of the label.                    | No         |
| To_replace    | The string to replace inside of the label.                         | No         |

```
import havocui

widget = havocui.Widget("Title")

def callback():
	global widget
	widget.replaceLabel("change me", "changed to something new")

widget.addLabel("change me")
widget.addButton("change the label", callback)
widget.setSmallTab()
```

![replace label widget](/images/assets/pythonapi/replacelabelwidget.png)

##### havocui.Widget().clear()

A function to clear the content of a widget. This function takes no arguments.

```
import havocui

widget = havocui.Widget("Title")

def callback():
	global widget
	widget.clear()

widget.addLabel("will go away")
widget.addButton("click to clear dialog", callback)
widget.setSmallTab()
```

![clear widget](/images/assets/pythonapi/clearwidget.png)

#### havocui.Logger()

A python module to create a predefined logging widget window where you can send
logs too to be displayed inside of a tab. The logs also accept HTML format for
styling.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the Logging widget.                                   | No         |

```
import havocui

logger = havocui.Logger("Title")
```

![logger example](/images/assets/pythonapi/loggerexample.png)

##### havocui.Logger().setBottomTab()

A function to display the widget on the screen as a bottom tab. This function
takes no arguments and returns nothing.

```
import havocui

logger = havocui.Logger("Title")
logger.setBottomTab() # will display the widget as a bottom tab.
```

![set bottom tab](/images/assets/pythonapi/setbottomtab.png)

##### havocui.Logger().setSmallTab()

A function to display the widget on the screen as a small tab to the right.
This function takes no arguments and returns nothing.

```
import havocui

logger = havocui.Logger("Title")
logger.setSmallTab() # will display the widget as a small tab to the right.
```

![set small tab](/images/assets/pythonapi/setsmalltab.png)

##### havocui.Logger().addText()

A function to append text inside of the logger window. This function takes one argument.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Text          | The text present inside of the label.                              | No         |

_The text also have support for html styling._

```
import havocui

logger = havocui.Logger("Title")
logger.addText("Hello World!")
logger.addText("<span style=\"color: red\">Hello red!</span>")
logger.setSmallTab()
```

![add text logger](/images/assets/pythonapi/addtextlogger.png)

##### havocui.Logger().clear()

A function to clear the content inside of a logger instance.

```
import havocui

logger = havocui.Logger("Title")
logger.addText("Hello World!")
logger.clear()
logger.setSmallTab()
```

#### havocui.Tree()

A python module to create a predefined Tree widget window where you can organise
data in a tree structure.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Title         | The title of the Tree widget.                                      | No         |
| Callback      | The function called when a item in the tree is selected.           | No         |

```
import havocui

def callback(data):
	print(data)

tree = havocui.Tree("Title", callback)
```

![tree example](/images/assets/pythonapi/treeexample.png)

##### havocui.Tree().setBottomTab()

A function to display the widget on the screen as a bottom tab. This function
takes no arguments and returns nothing.

```
import havocui

def callback(data):
	print(data)

tree = havocui.Tree("Title", callback)
tree.setBottomTab() # will display the widget as a bottom tab.
```

![set bottom tab](/images/assets/pythonapi/setbottomtab.png)

##### havocui.Tree().setSmallTab()

A function to display the widget on the screen as a small tab to the right.
This function takes no arguments and returns nothing.

```
import havocui

def callback(data):
	print(data)

tree = havocui.Tree("Title", callback)
tree.setSmallTab() # will display the widget as a small tab to the right.
```

![set small tab](/images/assets/pythonapi/setsmalltab.png)

##### havocui.Tree().addRow()

A function to add a row under the root element of the tree. This function takes
an infinite number of arguments to add children to the created node.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| Option        | The first option to the tree row.                                  | No         |
| Option        | The rest of the arguments are infinite for the different children. | Yes        |

```
import havocui

def callback(data):
	print(data)

tree = havocui.Tree("Title", callback)
tree.addRown("Users", "me", "you", "us")
tree.setBottomTab()
```

![add row tree](/images/assets/pythonapi/addrowtree.png)

##### havocui.Tree().setItem()

A function to add a item at the specified x and y postion. This function takes
three arguments.

| Arguments     | Description                                                        | Optional   |
| --------------|------------------------------------------------------------------- | ---------- |
| X             | The X position of the element.                                     | No         |
| Y             | The Y position of the element.                                     | No         |
| Element       | The text of the element to be inserted.                            | No         |

```
import havocui

def callback(data):
	print(data)

tree = havocui.Tree("Title", callback)
tree.setItem(1, 1, "data")
tree.setBottomTab()
```

![set item tree](/images/assets/pythonapi/setitemtree.png)

## Examples

### External resources
Provided are different blog posts where people from the community have extended havoc through the API
 - [Extending Havoc C2](https://codex-7.gitbook.io/codexs-terminal-window/red-team/red-team-dev/extending-havoc-c2)
 - [Shhhavoc dev log](https://jakobfriedl.github.io/blog/shhhavoc.html)
 - [Havocui module devlog](https://leosmith.wtf/blog/havoc-c2-pythonapi.html)
 - [Havocui Widget module devlog](https://leosmith.wtf/blog/havocui-widget-python.html)
 - [Havocui Logger module devlog](https://leosmith.wtf/blog/havoc-gui-advancements.html)
 - [Havocui Style widget devlog](https://leosmith.wtf/blog/havoc-again.html)

### Shhhavoc.py
#### Description
A port of the [Shhhloader](https://github.com/icyguider/Shhhloader) program to
the havoc user interface.
[Source Code](https://gist.github.com/jakobfriedl/0887eb75b31b96568526521282e63681)
#### screenshots
![Shhhloader dialog](/images/assets/pythonapi/example/shhhavoc.png)

### auto_suite.py
#### Description
A simple group of widget to automate common tasks on Havoc. Like searching files
and auto-running commands on connect.
[Source Code](https://gist.github.com/p4p1/e24bca8407d69c8ea28d4bc9d423f85b)
#### screenshots
![autosuite tab](/images/assets/pythonapi/example/autosuite.png)

### template.py
#### Description
A template module to register a command that will spawn a test dll inside of a
demon.
[Source Code](https://github.com/HavocFramework/Modules/tree/main/Template)
