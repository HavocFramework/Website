# 12. Client Script

This section is in work. It will be published soon.

![Spiderman Work](/images/Spiderman_work.png)

## Python API

### havoc

The main havoc library that allows you to interact with core components of Havoc,
from listeners to connected demons and registering commands and events.

```
import havoc
```

##### havoc.LoadScript()

A function that takes a string as an argument to represent the path of a python
script that will then be loaded into havoc.

```
import havoc

havoc.LoadScript("/tmp/havoc_python_script.py")
```

##### havoc.GetDemons()

A function that takes no arguments and will return a list of strings containing
every Demon ID connected to havoc.

```
import havoc

print(havoc.GetDemons()) # should result in [ "a havoc id", "another", .... ]
```

##### havoc.GetListeners()

A function that takes no arguments and will return a list of strings containing
the different listeners configured inside of havoc.

```
import havoc

print(havoc.GetListeners()) # should result in [ "a listener", "another", .... ]
```

##### havoc.GetAgents()

A function that takes no arguments and will return a list of strings containing
the different Agents configured inside of havoc. By default this function will
only return "Demon" unless you specified other Agents.

```
import havoc

print(havoc.GetAgents()) # should result in [ "Demon", .... ]
```

##### havoc.GeneratePayload()

A function that takes multiple arguments defined below to schedule the generation
of a payload and receive the base64 binary code and transfer it back to a python
callback.

| Argument | Description                                                        | Optional   |
| ---------|------------------------------------------------------------------- | ---------- |
| callback | The callback function where the base 64 will be parsed as argument | No         |
| agent    | The agent that will be used during the payload generation          | No         |
| listener | The specified listener the agent will call back to                 | No         |
| arch     | The architecture of the generated payload (x64 or x86)             | No         |
| format   | The format of the generated payload (exe or dll for example)       | No         |
| config   | The configuration of the payload                                   | No         |

```
import havoc

def catch_payload(data):
    print(data)

havoc.GeneratePayload(catch_payload, "Demon", "HTTPS Listener", "x64", "Windows Exe", "{\"Amsi/Etw Patch\": \"None\",\"Indirect Syscall\": false,\"Injection\": {\"Alloc\": \"Native/Syscall\",\"Execute\": \"Native/Syscall\",\"Spawn32\": \"C:\\\\Windows\\\\SysWOW64\\\\notepad.exe\",\"Spawn64\": \"C:\\\\Windows\\\\System32\\\\notepad.exe\"},\"Jitter\": \"15\",\"Proxy Loading\": \"None (LdrLoadDll)\",\"Sleep\": \"2\",\"Sleep Technique\": \"WaitForSingleObjectEx\",\"Stack Duplication\": false}")
```

##### havoc.RegisterCommand()

A function to register a command to the havoc command line interface when
interacting with an agent.

| Argument    | Description                                                                           | Optional   |
| ------------|-------------------------------------------------------------------------------------- | ---------- |
| function    | The callback function that will be called when running the function.                  | No         |
| module      | The string representing the module of the command.                                    | No         |
| command     | The string representing the command.                                                  | No         |
| description | The description of the command .                                                      | No         |
| behaviour   | set the behaviour of the command. For now keep at 0 it is still under developement.   | No         |
| usage       | The usage of the command.                                                             | No         |
| example     | An example on how to use the command.                                                 | No         |
| agent       | The specific agent that you want the command to be defined to. Default is all agents. | Yes        |

```
import havoc

def samdump(demonID, *params):
    TaskID : str    = None
    demon  : Demon  = None
    packer = Packer()
    # ... more code
    # see full example in the SamDump module
    # https://github.com/HavocFramework/Modules

RegisterCommand( samdump, "", "samdump", "Dump the SAM, SECURITY and SYSTEM registries", 0, "<folder>", "C:\\Windows\\Temp\\" )
```

##### havoc.RegisterModule()

A function to register a module to the havoc command line interface that will then
store multiple commands under the module.

| Argument    | Description                                                                                        | Optional   |
| ------------|--------------------------------------------------------------------------------------------------- | ---------- |
| Name        | The name of the module that will store the commands                                                | No         |
| description | The description of the Module.                                                                     | No         |
| behaviour   | set the behaviour of the module. For now keep as an empty string it is still under development.    | No         |
| usage       | The usage of the module.                                                                           | No         |
| example     | An example on how to use the command.                                                              | No         |
| Options     | Still under development.                                                                           | No         |

```
import havoc

# more code ...
# see full example in the jmp-exec module
# https://github.com/HavocFramework/Modules

RegisterModule( "jump-exec", "lateral movement module", "", "[exploit] (args)", "", ""  )
```

##### havoc.RegisterCallback()

A function to register a callback inside of Havoc.

| Argument    | Description                      | Optional   |
| ------------|--------------------------------- | ---------- |
| callback    | The function that will be called | No         |

_it is more recommended to use Events_

```
import havoc

def callback(text):
    print('this is a callback')

havoc.RegisterCallback(callback)
```

#### havoc.Demon()

##### havoc.Demon().ConsoleWrite()
##### havoc.Demon().ProcessCreate()
##### havoc.Demon().InlineExecute()
##### havoc.Demon().InlineExecuteGetOutput()
##### havoc.Demon().DllSpawn()
##### havoc.Demon().DllInject()
##### havoc.Demon().DotnetInlineExecute()
##### havoc.Demon().Command()

#### havoc.Event()

##### havoc.Event().OnNewSession()

### havocui

##### havocui.messagebox()
##### havocui.errormessage()
##### havocui.createtab()
##### havocui.inputdialog()
##### havocui.openfiledialog()
##### havocui.savefiledialog()
##### havocui.questiondialog()
##### havocui.colordialog()
##### havocui.progressdialog()

#### havocui.Dialog()

##### havocui.Dialog().exec()
##### havocui.Dialog().close()
##### havocui.Dialog().addLabel()
##### havocui.Dialog().addImage()
##### havocui.Dialog().addButton()
##### havocui.Dialog().addCheckbox()
##### havocui.Dialog().addCombobox()
##### havocui.Dialog().addLineedit()
##### havocui.Dialog().addCalendar()
##### havocui.Dialog().addDial()
##### havocui.Dialog().addSlider()
##### havocui.Dialog().replaceLabel()
##### havocui.Dialog().clear()

#### havocui.Widget()

##### havocui.Dialog().setBottomTab()
##### havocui.Dialog().setSmallTab()
##### havocui.Dialog().addLabel()
##### havocui.Dialog().addImage()
##### havocui.Dialog().addButton()
##### havocui.Dialog().addCheckbox()
##### havocui.Dialog().addCombobox()
##### havocui.Dialog().addLineedit()
##### havocui.Dialog().addCalendar()
##### havocui.Dialog().addDial()
##### havocui.Dialog().addSlider()
##### havocui.Dialog().replaceLabel()
##### havocui.Dialog().clear()

#### havocui.Logger()

##### havocui.Dialog().setBottomTab()
##### havocui.Dialog().setSmallTab()
##### havocui.Dialog().addText()
##### havocui.Dialog().clear()

#### havocui.Tree()
##### havocui.Tree().addRow()
##### havocui.Tree().setItem()
##### havocui.Tree().setBottomTab()
##### havocui.Tree().setSmallTab()

## Examples
